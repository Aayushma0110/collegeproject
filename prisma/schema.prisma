generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  Int           @id @default(autoincrement())
  name                String
  email               String        @unique
  password            String
  dateOfBirth         DateTime?
  gender              String?
  medicalHistory      String?
  specialty           String?
  experience          Int?
  fees                Float?
  ratings             Float?
  availability        Json?
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
  status              DoctorStatus  @default(PENDING)
  role                Role
  phoneNumber         String[]      @db.Char
  profilePicture_     String[]      @map("  profilePicture ") @db.Char
  doctorAppointments  Appointment[] @relation("DoctorAppointments")
  patientAppointments Appointment[] @relation("PatientAppointments")
}

model Appointment {
  id          Int      @id @default(autoincrement())
  mode        Mode     @default(IN_PERSON)
  status      Status   @default(PENDING)
  patientId   Int
  doctorId    Int
  createdAt   DateTime @default(now())
  duration    Int?
  scheduledAt DateTime
  doctor      User     @relation("DoctorAppointments", fields: [doctorId], references: [id])
  patient     User     @relation("PatientAppointments", fields: [patientId], references: [id])
  payment     Payment?
}

model Payment {
  id            Int           @id @default(autoincrement())
  amount        Float
  method        PaymentMethod
  status        PaymentStatus @default(PENDING)
  transactionId String?
  appointmentId Int           @unique
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  appointment   Appointment   @relation(fields: [appointmentId], references: [id])
}

enum Role {
  PATIENT
  DOCTOR
  ADMIN
}

enum Mode {
  IN_PERSON
  ONLINE
}

enum Status {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum PaymentMethod {
  CASH
  CARD
  STRIPE
  ESEWA
  KHALTI
}

enum PaymentStatus {
  PENDING
  SUCCESS
  FAILED
  REFUNDED
}

enum DoctorStatus {
  PENDING
  APPROVED
  REJECTED
}
